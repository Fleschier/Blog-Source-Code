---
layout:     post
title:      "C++学习笔记——强大的sprintf"
date:       2018-10-08 22:43:00
categories: Computer Programes
tags: ๑C++
---

## sprintf()函数与printf()函数
---

- `sprintf()`函数与`printf()`函数的用法几乎一样。只是前者是将内容打印到字符串中，后者直接在命令行打印出来。

- `sprintf()`函数原型： `int sprintf( char *buffer, const char *format [, argument] ... );` 除了前两个参数固定，后面可以接任意多个参数。

- 第二个参数为格式化字符串，`printf` 和`sprintf` 都使用格式化字符串来指定串的格式，以`%`开头，然后在后边的变参列表中提供相应的变量，最终相应的位置的变量就会被替换进来。


- `sprintf`最常见的应用之一莫过于把整数打印到字符串中，所以，`spritnf` 在大多数场合可以替代`itoa`。

- 例子：
```
sprintf(s, "%d", 123);
sprintf(s, "%8d%8d", 123, 5678);  //指定宽度，不足的左边补空格，结果为" 123 5678"
```

- 浮点数用`%f`控制，默认打印6位小数。

- 使用`%d`或者`%x`打印一个字符，便能得出它的10进制或16进制的ASCII码；反过来，使用`%c`打印一个整数，便可以看到它所对应的ASCII字符。**因为char类型本质上也是存储数值类型，只是习惯上用char来表示字符，实际上char就是byte，一个字节的数值类型。**

- [实现各种各样格式化字符串](http://lib.csdn.net/article/cplusplus/29221)

- `sprinf`就是将格式化字符串里的所有内容打印到第一个参数(字符数组)中，因此也可以用来连接字符串，非常灵活。

- `spritnf`和`printf`都最终返回本次函数调用最终打印到字符缓冲区中的字符数目。

## 转换说明符
---

### 格式符

|格式符|说明|
|---|---|
|%a(%A)    | 浮点数、十六进制数字和p-(P-)记数法(C99)|
|%c        | 字符 |
|%d        | 有符号十进制整数 |
|%f        | 浮点数(包括float和doulbe)  |
|%e(%E)    | 浮点数指数输出[e-(E-)记数法] |
|%g(%G)    | 浮点数不显无意义的零"0"  |
|%i        | 有符号十进制整数(与%d相同)  |
|%u        | 无符号十进制整数 |
|%o        | 八进制整数  |
|%x(%X)    | 十六进制整数0f(0F) |
|%p        | 指针 |
|%s        | 字符串  |
|%%        | 输出字符%  |

### 标志
|标志|例子(说明)|
|---|---|
|左对齐："-"| %-20s|
|右对齐："+"| %+20s|
|空格| 若符号为正，则显示空格，负则显示"-"  比如："% 6.2f"|      
|#| 对c,s,d,u类无影响；对o类，在输出时加前缀o；对x类，在输出时加前缀0x；对e,g,f 类当结果有小数时才给出小数点。|

## sprintf使用过程中遇到的一些问题记录
---

### 编译器报错：`Buffer is too small`

- 出现这个情况是因为被赋值的字符数组太小了。

- 实例：(矩阵乘积)
```
//计算矩阵的乘积
...
...
	char tmpc[24];		//存储转换的值,因为存储的是双精度浮点数，这里数据的整数部分为10位，小数部分要显示11位则至少开10+1+11=22位的数组才够
	for (int i = 0; i < M; i++) {
		for (int j = 0; j < N; j++) {
			C[i][j] = 0;			//initialize the result martrix element
			for (int k = 0; k < K; k++) {
				C[i][j] += A[i][k] * B[k][j];
			}
			//---------------------------------------------------------------------------------------------
			//itoa不如sprintf灵活，这里采用sprintf来完成double到char的转换
			////将数字转化为char数组写入, 采用itoa函数。函数原型：char *itoa(int value, char* string, int radix);
			//_itoa(C[i][j], tmpc, 10);
			//fputs(tmpc, fout);		//fputs的第一个参数为char*
			//fputc(32, fout);			//写入空格，fputc的第一个参数为int*(ASCII码)
			//---------------------------------------------------------------------------------------------
			//使用强大的sprintf来完成转换，打印11位小数
			sprintf_s(tmpc, "%.11f ", C[i][j]);				//这里的数值是整数部分10位，小数点一位，小数部分11位，末尾空格1位，结束符'\0'一位所以一共要开24位的数组才够
			fputs(tmpc, fout);		//fputs的第一个参数为char*
		}
		fputc(10, fout);		//写入换行符
	}
  ...
```
